- unless @comments.empty?
  %h3=_("Comments")
  - for comment in @comments
    %div{:id=>"comment_#{comment.id}", :class=>"comment"}
      %div{:class=>"created_user"}
        %b=comment.user.name.nil? ? comment.user.email : comment.user.name
      %div{:class=>"comments"}
        =comment.comment.gsub("\n","<br/>")
      %div{:class=>"popup_comment_changins"}
        %div
          - unless comment.before_responsible_id == comment.responsible_id
            %label=_("Resp. changed from ")
            %b= comment.before_responsible_id.nil? ? _("--none--") : User.find(comment.before_responsible_id).email
            %label=_(" to ")
            %b= comment.responsible_id.nil? ? _("--none--") : User.find(comment.responsible_id).email
        %div
          - unless comment.before_state == comment.state
            %label=_("State changed from ")
            %b= ticket_state(comment.before_state)
            %label=_(" to ")
            %b= ticket_state(comment.state)
        %div
          - unless comment.before_urgency == comment.urgency
            %label=_("Urgency changed from ")
            %b= ticket_urgency(comment.before_urgency)
            %label=_(" to ")
            %b= ticket_urgency(comment.urgency)
        %div
          - unless comment.before_severity == comment.severity
            %label=_("Severity changed from ")
            %b=ticket_severity(comment.before_severity)
            %label=_(" to ")
            %b=ticket_severity(comment.severity)
        %div
          - unless comment.before_milestone_id == comment.milestone_id
            %label=_("Milestone change from ")
            %b= Milestone.find(comment.before_milestone_id).name
            %label=_(" to ")
            %b= Milestone.find(comment.milestone_id).name
